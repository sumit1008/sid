D2. Turtle and a MEX Problem (Hard Version)
The two versions are different problems. In this version of the problem, you can't choose the same integer twice or more. You can make hacks only if both versions are solved.
One day, Turtle was playing with ğ‘›n sequences. Let the length of the ğ‘–i-th sequence be ğ‘™ğ‘–li. Then the ğ‘–i-th sequence was ğ‘ğ‘–,1,ğ‘ğ‘–,2,â€¦,ğ‘ğ‘–,ğ‘™ğ‘–ai,1,ai,2,â€¦,ai,li.
Piggy gave Turtle a problem to solve when Turtle was playing. The statement of the problem was:
  - There was a non-negative integer ğ‘¥x at first. Turtle would perform an arbitrary number (possibly zero) of operations on the integer.
  - In each operation, Turtle could choose an integer ğ‘–i such that 1â‰¤ğ‘–â‰¤ğ‘›1â‰¤iâ‰¤n and ğ‘–i wasn't chosen before, and set ğ‘¥x to mexâ€ (ğ‘¥,ğ‘ğ‘–,1,ğ‘ğ‘–,2,â€¦,ğ‘ğ‘–,ğ‘™ğ‘–)mexâ€ (x,ai,1,ai,2,â€¦,ai,li).
  - Turtle was asked to find the answer, which was the maximum value of ğ‘¥x after performing an arbitrary number of operations.
Turtle solved the above problem without difficulty. He defined ğ‘“(ğ‘˜)f(k) as the answer to the above problem when the initial value of ğ‘¥x was ğ‘˜k.
Then Piggy gave Turtle a non-negative integer ğ‘šm and asked Turtle to find the value of âˆ‘ğ‘–=0ğ‘šğ‘“(ğ‘–)âˆ‘i=0mf(i) (i.e., the value of ğ‘“(0)+ğ‘“(1)+â€¦+ğ‘“(ğ‘š)f(0)+f(1)+â€¦+f(m)). Unfortunately, he couldn't solve this problem. Please help him!
â€ mex(ğ‘1,ğ‘2,â€¦,ğ‘ğ‘˜)â€ mex(c1,c2,â€¦,ck) is defined as the smallest non-negative integer ğ‘¥x which does not occur in the sequence ğ‘c. For example, mex(2,2,0,3)mex(2,2,0,3) is 11, mex(1,2)mex(1,2) is 00.
Tags -dfs and similar
Tags -dp
Tags -graphs
Tags -greedy
Tags -implementation
Tags -math
Tags -*2100

B2. Reverse Card (Hard Version)
The two versions are different problems. You may want to read both versions. You can make hacks only if both versions are solved.
You are given two positive integers ğ‘›n, ğ‘šm.
Calculate the number of ordered pairs (ğ‘,ğ‘)(a,b) satisfying the following conditions:
  - 1â‰¤ğ‘â‰¤ğ‘›1â‰¤aâ‰¤n, 1â‰¤ğ‘â‰¤ğ‘š1â‰¤bâ‰¤m;
  - ğ‘â‹…gcd(ğ‘,ğ‘)bâ‹…gcd(a,b) is a multiple of ğ‘+ğ‘a+b.
Tags -brute force
Tags -math
Tags -number theory
Tags -*2200

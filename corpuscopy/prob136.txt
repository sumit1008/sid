C2. Shohag Loves XOR (Hard Version)
This is the hard version of the problem. The differences between the two versions are highlighted in bold. You can only make hacks if both versions of the problem are solved.
Shohag has two integers x and m. Help him count the number of integers 1≤y≤m such that x⊕y is divisible∗ by either x, y, or both. Here ⊕ is the bitwise XOR operator.
Tags -bitmasks
Tags -brute force
Tags -math
Tags -number theory
Tags -*1800

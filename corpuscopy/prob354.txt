E2. Turtle and Inversions (Hard Version)
This is a hard version of this problem. The differences between the versions are the constraint on ğ‘šm and ğ‘Ÿğ‘–<ğ‘™ğ‘–+1ri<li+1 holds for each ğ‘–i from 11 to ğ‘šâˆ’1mâˆ’1 in the easy version. You can make hacks only if both versions of the problem are solved.
Turtle gives you ğ‘šm intervals [ğ‘™1,ğ‘Ÿ1],[ğ‘™2,ğ‘Ÿ2],â€¦,[ğ‘™ğ‘š,ğ‘Ÿğ‘š][l1,r1],[l2,r2],â€¦,[lm,rm]. He thinks that a permutation ğ‘p is interesting if there exists an integer ğ‘˜ğ‘–ki for every interval (ğ‘™ğ‘–â‰¤ğ‘˜ğ‘–<ğ‘Ÿğ‘–liâ‰¤ki<ri), and if he lets ğ‘ğ‘–=maxğ‘—=ğ‘™ğ‘–ğ‘˜ğ‘–ğ‘ğ‘—,ğ‘ğ‘–=minğ‘—=ğ‘˜ğ‘–+1ğ‘Ÿğ‘–ğ‘ğ‘—ai=maxj=likipj,bi=minj=ki+1ripj for every integer ğ‘–i from 11 to ğ‘šm, the following condition holds:
maxğ‘–=1ğ‘šğ‘ğ‘–<minğ‘–=1ğ‘šğ‘ğ‘–maxi=1mai<mini=1mbi
Turtle wants you to calculate the maximum number of inversions of all interesting permutations of length ğ‘›n, or tell him if there is no interesting permutation.
An inversion of a permutation ğ‘p is a pair of integers (ğ‘–,ğ‘—)(i,j) (1â‰¤ğ‘–<ğ‘—â‰¤ğ‘›1â‰¤i<jâ‰¤n) such that ğ‘ğ‘–>ğ‘ğ‘—pi>pj.
Tags -brute force
Tags -data structures
Tags -divide and conquer
Tags -dp
Tags -greedy
Tags -math
Tags -two pointers
Tags -*2700

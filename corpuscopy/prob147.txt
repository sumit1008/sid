F. Alternative Platforms
Suppose you are working in the Ministry of Digital Development of Berland, and your task is to monitor the industry of video blogging.
There are nğ‘› bloggers in Berland. Recently, due to the poor state of the main video platform in Berland, two alternative platforms were introduced. That's why bloggers started to reupload their videos to these alternative platforms. You've got the statistics that the iğ‘–-th blogger uploaded viğ‘£ğ‘– videos to the first alternative platform and riğ‘Ÿğ‘– videos to the second alternative platform.
You think that a potential user will be upset if even at least one of his favorite bloggers doesn't upload anything. However, if a blogger uploads videos to both platforms, the user will watch that blogger on the platform where more videos are available. So, you've come up with the following function to estimate user experience. Suppose a user watches kğ‘˜ bloggers b1,b2,â€¦,bkğ‘1,ğ‘2,â€¦,ğ‘ğ‘˜; then, let user experience be E(b1,â€¦,bk)=max(mini=1..kv[bi],mini=1..kr[bi]).ğ¸(ğ‘1,â€¦,ğ‘ğ‘˜)=max(minğ‘–=1..ğ‘˜ğ‘£[ğ‘ğ‘–],minğ‘–=1..ğ‘˜ğ‘Ÿ[ğ‘ğ‘–]).
In order to get some statistics, you want to calculate the value avgkavgğ‘˜ that is equal to an average experience among all subsets of bloggers of size kğ‘˜. Also, you have to calculate avgkavgğ‘˜ for each kğ‘˜ from 11 to nğ‘›.
Since answers may be too large, print them modulo 998244353998244353.
Tags -combinatorics
Tags -data structures
Tags -fft
Tags -math
Tags -sortings
Tags -*2500

F2. Shohag Loves Counting (Hard Version)
This is the hard version of the problem. The only differences between the two versions of this problem are the constraints on ğ‘¡t, ğ‘šm, and the sum of ğ‘šm. You can only make hacks if both versions of the problem are solved.
For an integer array ğ‘a of length ğ‘›n, define ğ‘“(ğ‘˜)f(k) as the greatest common divisor (GCD) of the maximum values of all subarraysâˆ—âˆ— of length ğ‘˜k. For example, if the array is [2,1,4,6,2][2,1,4,6,2], then ğ‘“(3)=gcd(max([2,1,4]),max([1,4,6]),max([4,6,2]))=gcd(4,6,6)=2f(3)=gcdâ¡(maxâ¡([2,1,4]),maxâ¡([1,4,6]),maxâ¡([4,6,2]))=gcdâ¡(4,6,6)=2.
An array is good if ğ‘“(ğ‘–)â‰ ğ‘“(ğ‘—)f(i)â‰ f(j) is satisfied over all pairs 1â‰¤ğ‘–<ğ‘—â‰¤ğ‘›1â‰¤i<jâ‰¤n.
Shohag has an integer ğ‘šm. Help him count the number, modulo 998244353998244353, of non-empty good arrays of arbitrary length such that each element of the array is an integer from 11 to ğ‘šm.
Tags -dp
Tags -number theory
Tags -*3200

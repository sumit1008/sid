E2. Catch the Mole(Hard Version)
This is the hard version of the problem. The only difference is the limit on the number of queries.
This is an interactive problem.
You are given a tree of n𝑛 nodes with node 11 as its root node.
There is a hidden mole in one of the nodes. To find its position, you can pick an integer x𝑥 (1≤x≤n1≤𝑥≤𝑛) to make an inquiry to the jury. Next, the jury will return 11 when the mole is in subtree x𝑥. Otherwise, the judge will return 00. If the judge returns 00 and the mole is not in root node 11, the mole will move to the parent node of the node it is currently on.
Use at most 160160 operations to find the current node where the mole is located.
Tags -binary search
Tags -data structures
Tags -dfs and similar
Tags -divide and conquer
Tags -interactive
Tags -trees
Tags -*2600

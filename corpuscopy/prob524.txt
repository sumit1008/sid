G. Yasya and the Mysterious Tree
Yasya was walking in the forest and accidentally found a tree with ğ‘›n vertices. A tree is a connected undirected graph with no cycles.
Next to the tree, the girl found an ancient manuscript with ğ‘šm queries written on it. The queries can be of two types.
The first type of query is described by the integer ğ‘¦y. The weight of each edge in the tree is replaced by the bitwise exclusive OR of the weight of that edge and the integer ğ‘¦y.
The second type is described by the vertex ğ‘£v and the integer ğ‘¥x. Yasya chooses a vertex ğ‘¢u (1â‰¤ğ‘¢â‰¤ğ‘›1â‰¤uâ‰¤n, ğ‘¢â‰ ğ‘£uâ‰ v) and mentally draws a bidirectional edge of weight ğ‘¥x from ğ‘£v to ğ‘¢u in the tree.
Then Yasya finds a simple cycle in the resulting graph and calculates the bitwise exclusive OR of all the edges in it. She wants to choose a vertex ğ‘¢u such that the calculated value is maximum. This calculated value will be the answer to the query. It can be shown that such a cycle exists and is unique under the given constraints (independent of the choice of ğ‘¢u). If an edge between ğ‘£v and ğ‘¢u already existed, a simple cycle is the path ğ‘£â†’ğ‘¢â†’ğ‘£vâ†’uâ†’v.
Note that the second type of query is performed mentally, meaning the tree does not change in any way after it.
Help Yasya answer all the queries.
Tags -bitmasks
Tags -data structures
Tags -dfs and similar
Tags -graphs
Tags -greedy
Tags -strings
Tags -trees
Tags -*2300

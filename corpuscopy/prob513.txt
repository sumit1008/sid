E. Number of k-good subarrays
Let bit(x)ğ‘ğ‘–ğ‘¡(ğ‘¥) denote the number of ones in the binary representation of a non-negative integer xğ‘¥.
A subarray of an array is called kğ‘˜-good if it consists only of numbers with no more than kğ‘˜ ones in their binary representation, i.e., a subarray (l,r)(ğ‘™,ğ‘Ÿ) of array ağ‘ is good if for any iğ‘– such that lâ‰¤iâ‰¤rğ‘™â‰¤ğ‘–â‰¤ğ‘Ÿ condition bit(ai)â‰¤kğ‘ğ‘–ğ‘¡(ğ‘ğ‘–)â‰¤ğ‘˜ is satisfied.
You are given an array ağ‘ of length nğ‘›, consisting of consecutive non-negative integers starting from 00, i.e., ai=iğ‘ğ‘–=ğ‘– for 0â‰¤iâ‰¤nâˆ’10â‰¤ğ‘–â‰¤ğ‘›âˆ’1 (in 00-based indexing). You need to count the number of kğ‘˜-good subarrays in this array.
As the answer can be very large, output it modulo 109+7109+7.
Tags -bitmasks
Tags -brute force
Tags -combinatorics
Tags -divide and conquer
Tags -dp
Tags -math
Tags -meet-in-the-middle
Tags -*2300
